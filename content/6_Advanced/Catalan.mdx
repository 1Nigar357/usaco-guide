---
id: catalan
title: 'Catalan Numbers'
author: Mihnea Brebenel
description: ''
prerequisites:
  - combo
frequency: 1
---

<Resources>
	<Resource
		source="cp-algo"
		title="Catalan Numbers"
		url="https://cp-algorithms.com/combinatorics/catalan-numbers.html"
		starred
	>
		Well documented article.
	</Resource>
</Resources>

The [Catalan numbers](https://en.wikipedia.org/wiki/Catalan_number) are a sequence of positive integers that can be very useful in counting problems in combinatorics.
The $n$-th Catalan can be expressed as following using binomial coeffiecients:

$$
C_n=\frac{1}{n+1}\cdot \binom{2n}{n}=\frac{(2n)!}{(n+1)!\,n!}
$$

They also have the recurrence formula
$$
C_{n+1}= \sum^{n}_{i=0}{C_i \cdot C_{n-i}} \,\,\, \text{ for } n \ge 0 \\
$$
which can also be expressed as
$$
C_n=\frac{2(2n-1)}{n+1} \cdot C_{n-1}
$$

The first $5$ Catalan numbers are

<center>

| n | 0| 1 | 2 | 3 | 4 | 5 |
|---| -| - | - | - | - | - |
| $C_n$| 1 | 1 | 2 | 5 | 14| 42 |

</center>

# Applications

The Catalan numbers can be used to represent a wide variety of things.

For example, $C_n$ is equal to the number of valid parenthesis expressions of length $2n$.
Take, for instance, $C_3=5$:
* `()()()`
* `(())()`
* `()(())`
* `((()))`
* `(()())`

It's also equal to the number of full binary trees with $n+1$ leaves.
The following image shows the $5$ binary trees with $4$ leaves:

![binary-trees](./assets/catalan-binary-trees.png)

$C_n$ is also the number of monotonic lattice paths along the edges of a $n \times n$ grid that don't pass above the diagonal.
The paths start in the lower left corner and ends in the upper right corner.

For example, there are $C_4=14$ paths in a $4 \times 4 grid$:

![lattice points](./assets/catalan-lattice-paths.png)

The next two examples are a bit more niche, but they're still interesting to think about.

Consider a convex polygon with $n+2$ sides divided into $n$ triangles by connecting vertices with non-intersecting lines.
The number of different ways to divide the polygon in this way is equal to $C_n$.

Here's the particular case for $n=3$ in which we have $C_3=5$:

![polygons](./assets/catalan-polygons.png)

$C_n$ is also equal to the number of [mountain ranges](https://mathcircle.berkeley.edu/sites/default/files/BMC6/pdf0607/catalan.pdf#page=2) of length $2n$ consisting of $n$ upstrokes and $n$ downstrokes.

![mountains](./assets/catalan-mountain-strokes.png)

# Bracket Sequences I

<FocusProblem problem="sample" />

## Explanation

The problem is a direct application of Catalan numbers. The answer for $N$ is the $N/2$ Catalan Number.

## Implementation

**Time Complexity:** $\mathcal{O}(N \cdot \log{N})$

<LanguageSection>
<CPPSection>

```cpp
#include <iostream>

using namespace std;

int main() {
	const int MOD = 1e9 + 7;

	int N;
	cin >> N;

	if (N & 1) {
		cout << 0;
		return 0;
	}

	auto exp = [&](int x, int y) -> int {
		int ans = 1, aux = x;
		for (int i = 0; (1LL << i) <= y; i++) {
			if ((1LL << i) & y) { ans = 1LL * ans * aux % MOD; }
			aux = 1LL * aux * aux % MOD;
		}
		return ans;
	};

	auto inv = [&](int x) -> int { return exp(x, MOD - 2); };

	auto fact = [&](int x) -> int {
		int ans = 1;
		for (int i = 1; i <= x; i++) { ans = 1LL * ans * i % MOD; }
		return ans;
	};

	auto comb = [&](int n, int k) {
		return 1LL * fact(n) * inv(fact(k)) % MOD * inv(fact(n - k)) % MOD;
	};

	cout << 1LL * inv(N / 2 + 1) * comb(N, N / 2) % MOD;
}
```

</CPPSection>
</LanguageSection>

<Problems problems="catalan-practice" />
