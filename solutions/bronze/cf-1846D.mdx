---
id: cf-1846D
source: CF
title: Rudolph and Christmas Tree
author: Rameez Parwez
---

[Official Editorial (C++)](https://codeforces.com/blog/entry/118044)

## Explanation

There are two conditions to consider, what if:

- **The two triangles does not intersect each other (i.e. $y_i + h <= y_{i + 1}$)**: In this case, we simply add the area of the isosceles triangle to our answer, which is $\frac{base \cdot height}{2}$

- **The two triangles intersect each other (i.e. $y_i + h > y_{i + 1}$)**: In this case, the figure formed will be a trapezium and a triangle. We can add the area of the trapezium to our answer and move on to the next figure. To find the area of the trapezium, we have the lower base $d$ and height of the trapezium is $h' = y_{i + 1} - y_i$. To find the upper base length, first we need to calculate the ratio of the heights of the intersecting and original traingles, which is $p = \frac{h - h'}{h}$. Now, the upper base can be found using similarity of the triangles:
$$
	d_{top} = d * p = d * \frac{h - h'}{h}
$$

## Implementation
**Time Complexity:** $\mathcal{O}(N)$

<LanguageSection>
<CPPSection>
```cpp
#include <bits/stdc++.h>

int main() {
	int t;
	std::cin >> t;
	while (t--) {
		int n, d, h;
		std::cin >> n >> d >> h;
		std::vector<int> y(n);

		for (int i = 0; i < n; i++) {
			std::cin >> y[i];
		}

		std::cout << std::fixed << std::setprecision(16);
		long double res = 0;
		for (int i = 0; i < n; i++) {
			if (i == n - 1 || (i + 1 < n && y[i] + h <= y[i + 1])) { // non-intersecting traingles
				res += (double)(1LL * d * h) / 2;
			} else { // intersecting traingles
				int new_h = y[i + 1] - y[i];
				double p = (double)(h - new_h) / h;
				double dtop = 1LL * d * p;
				res += (double)(1LL * new_h * (d + dtop) / 2);
			}
		}
		std::cout << res << '\n';
	}
	return 0;
}
```
</CPPSection>

<PySection>
```py
test = int(input())
for _ in range(test):
    n, d, h = map(int, input().split())
    y = list(map(int, input().split()))

    res: float = 0
    for i in range(n):
        if i == n - 1 or (i + 1 < n and y[i] + h <= y[i + 1]): # non-intersecting triangles
            res = res + d * h / 2

        else: # intersecting triangles
            new_h = y[i + 1] - y[i]
            p = (h - new_h) / h
            dtop = d * p
            res = res + new_h * (d + dtop) / 2
    
    print(res)
```

</PySection>
</LanguageSection>