---
id: cf-1808B
source: CF 1808B
title: Playing in a Casino
author: Amit Singh Bisht
---

## Explanation

Essentially, the solution is to use nested loops to iterate through the columns input matrix, then calculate the sum of each column, and sort the elements of each column in non-descending order. Then calculate the absolute difference between the sum of the column and a running sum of the sorted elements. This difference is multiplied by the number of elements that come before it in the sorted order to obtain the contribution of that element to the final answer. The contributions of all elements in a column are then summed up to obtain the final answer for that column, and this process is repeated for all columns.

The idea behind this approach is that the current element is being used as a representative of all the elements in the column that are smaller than it. Therefore, the difference between the sum of all elements and the sum of all elements before the current element is the sum of all the elements that are greater than the current element. This difference is then multiplied by the number of rows minus one minus the number of rows before the current element to obtain the total number of inversions.

## Implementation

**Time Complexity:** $\mathcal{O}(MN \log N)$

<LanguageSection>
<CPPSection>

```cpp
#include <bits/stdc++.h>
using namespace std;
int main() {
	int t;
	cin >> t;
	for (int i = 0; i < t; i++) {
		int n, m;
		cin >> n >> m;
		vector<vector<int>> a(n, vector<int>(m));
		for (int i = 0; i < n; i++) {
			for (int j = 0; j < m; j++) { cin >> a[i][j]; }
		}

		long long ans = 0;
		for (int i = 0; i < m; i++) {
			vector<long long> temp;
			long long sum = 0;
			for (int j = 0; j < n; j++) {
				temp.push_back(a[j][i]);
				sum += a[j][i];
			}
			long long curr = 0;
			sort(temp.begin(), temp.end());
			for (int j = 0; j < n; j++) {
				curr += temp[j];
				ans += llabs((sum - curr) - (n - 1 - j) * temp[j]);
			}
		}

		cout << ans << "\n";
	}
}
```

</CPPSection>

<PySection>

```py
# using defaultdict from collections just to avoid silly error in flow of code
import collections

test = int(input())
for t in range(test):

	# taking input as a matrix

	n, m = map(int, input().split())
	matrix = []
	for i in range(n):
		matrix.append(list(map(int, input().split())))

	# Grouping columns using a dictionary

	hashmap = collections.defaultdict(list)
	for i in range(n):
		for j in range(m):
			hashmap[j].append(matrix[i][j])

	res = 0
	for i in range(m):
		temp = hashmap[i]
		temp = sorted(temp, reverse=True)
		suf = []
		prev = 0
		for i in temp[::-1]:
			suf.append(prev)
			prev += i
		ans = 0
		for i in range(n):
			ans += temp[i] * (n - i - 1) - suf[n - i - 1]
		res += ans
	print(res)
```

</PySection>
</LanguageSection>
